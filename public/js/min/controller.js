"use strict";function Controller(){this.enabled=!1,this.touchID=null,this.container=document.querySelector(".js--controller"),this.points=[],this.velocity={x:0,y:0,acceleration:0};var t=this;this.canvas=document.createElement("canvas"),this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.context=this.canvas.getContext("2d"),this.container.appendChild(this.canvas),this.canvas.addEventListener("touchstart",function(e){t.positionHandler(e,t)},!1),this.canvas.addEventListener("touchmove",function(e){t.positionHandler(e,t)},!1),this.canvas.addEventListener("touchend",function(e){t.positionHandler(e,t),t.touchID==e.changedTouches[0].identifier&&(t.enabled=!1,t.touchID=null)},!1)}window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)},Controller.prototype.positionHandler=function(t,e){t.clientX&&t.clientY?e.points[0]=t:t.targetTouches&&(e.points=t.targetTouches,t.preventDefault())},Controller.prototype.loop=function(){var t=this;this.canvas.height!=window.innerHeight&&(this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight),this.context.clearRect(0,0,this.canvas.width,this.canvas.height);var e={radius:75,gutter:24,x:function(){return this.radius+this.gutter},y:function(){return window.innerHeight-this.radius-this.gutter}};this.context.strokeStyle="#78879f",this.context.lineWidth="10",this.context.beginPath(),this.context.arc(e.x(),e.y(),e.radius,0,2*Math.PI,!0),this.context.stroke();var i={radius:35,x:e.x(),y:e.y()};eachNode(this.points,function(n){var o=Math.pow(e.radius,2),a=e.x()-n.clientX,c=e.y()-n.clientY,s=Math.pow(a,2)+Math.pow(c,2);if(o>s)t.enabled=!0,t.touchID=n.identifier,t.velocity.acceleration=100*s/o,i.x=n.clientX,i.y=n.clientY;else if(t.touchID==n.identifier)if(t.enabled){var r=e.radius/Math.sqrt(s),h=a*r,l=c*r;i.x=e.x()-h,i.y=e.y()-l,t.velocity.acceleration=100}else t.velocity={x:0,y:0,acceleration:0};t.touchID==n.indentifier&&t.enabled&&(e.x()>n.clientX?t.velocity.x=-1:e.x()<n.clientX&&(t.velocity.x=1),e.y()>n.clientY?t.velocity.y=1:e.y()<n.clientY&&(t.velocity.y=-1))}),this.context.fillStyle="#ffffff",this.context.beginPath(),this.context.arc(i.x,i.y,i.radius,0,2*Math.PI,!0),this.context.fill()},Controller.prototype.getVelocity=function(){return this.velocity};var Controller=new Controller;!function t(){requestAnimFrame(t),Controller.loop()}();