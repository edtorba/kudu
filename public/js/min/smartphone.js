window.onload=function(){"use strict";function e(e){e.addEventListener("click",function(e){e.preventDefault(),eachNode(n,function(e){e!=this&&(removeClass(e,"js--select-vehicle--selected"),removeClass(e,"car--selected"))}),hasClass(this,"js--select-vehicle--selected")||(addClass(this,"js--select-vehicle--selected"),addClass(this,"car--selected"))})}var t=new GameState(".js--state");t.switchto("enter-code");{var s=new Yell;new Fullscreen(".js--fullscreen")}socket.on("ownerLeft",function(e){t.switchto("enter-code"),s.setText(e.error),s.negative(),s.show()}),socket.on("disconnect",function(){t.switchto("enter-code"),s.setText("The game connection has been lost."),s.negative(),s.show()});var c=document.querySelector(".js--enter-code--join"),o=document.querySelector(".js--enter-code--code");c.onclick=function(e){e.preventDefault(),isEmpty(o.value)?(s.setText("Bad code"),s.negative(),s.show()):socket.emit("joinRoom",o.value)},socket.on("joinRoomStatus",function(e){e.status?(t.switchto("waiting-for-players"),o.value=""):(s.setText(e.error),s.negative(),s.show())});var n=document.querySelectorAll(".js--select-vehicle");socket.on("switchToSelectVehicle",function(e){if(e.status){var s=0;for(var c in e.cars)n[s].querySelector(".js--car__image").src=e.cars[c].image,n[s].dataset.vehicleName=e.cars[c].name,n[s].querySelector(".js--select-vehicle--name").innerHTML=e.cars[c].name,n[s].querySelector(".js--select-vehicle--armor").innerHTML=e.cars[c].armor,n[s].querySelector(".js--select-vehicle--speed").innerHTML=e.cars[c].speed,n[s].querySelector(".js--select-vehicle--power").innerHTML=e.cars[c].power,s++;t.switchto("select-vehicle")}}),eachNode(n,function(t){e(t)});var r=document.querySelector(".js--select-vehicle--ready");r.onclick=function(e){e.preventDefault;var t=document.querySelector(".js--select-vehicle--selected");t?socket.emit("selectVehicle",t.dataset.vehicleName):(s.setText("Please select vehicle first"),s.negative(),s.show())},socket.on("selectVehicleStatus",function(e){e.status?t.switchto("waiting-for-vehicles"):(s.setText(e.error),s.negative(),s.show())}),socket.on("playersReady",function(e){e.status&&(t.switchto("controller"),Controller.start())}),socket.on("freshHealth",function(e){e.status&&Controller.setHealthAndLives(e.health)}),socket.on("freshScore",function(e){e.status&&Controller.setScore(e.scoreAndMoney.score)}),socket.on("playerLostLife",function(e){e.status&&window.navigator.vibrate(1e3)})};